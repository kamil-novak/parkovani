const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./symbolLayerUtils-CumMKJY0.js","./index-i1xHX9d5.js","./index-BVy-TfK5.css"])))=>i.map(i=>d[i]);
import{fN as b,cp as a,dB as y,gx as m,gy as d,gz as g,gA as k,_ as z}from"./index-i1xHX9d5.js";import{C as S}from"./cimSymbolUtils-CH1c1428.js";new b(1e3);new a([128,128,128]);const x=new a("white");function N(t,n){if(!t)return null;let o=null;return y(t)?o=_(t):m(t)&&(o=t.type==="cim"?S(t):t.color?new a(t.color):null),o?h(o,n):null}function _(t){const n=t.symbolLayers;if(!n)return null;let o=null;return n.forEach(l=>{var i;l.type==="object"&&((i=l.resource)!=null&&i.href)||(o=l.type==="water"?l.color:l.material?l.material.color:null)}),o?new a(o):null}function h(t,n){if(n==null||t==null)return t;const o=t.toRgba();return o[3]=o[3]*n,new a(o)}function v(t,n,o){const l=t.symbolLayers;if(!l)return;const i=r=>h(n=n??r??(o!=null?x:null),o);l.forEach(r=>{var c,u;if(r.type!=="object"||!((c=r.resource)!=null&&c.href)||n)if(r.type==="water")r.color=i(r.color);else{const e=r.material!=null?r.material.color:null,s=i(e);r.material==null?r.material=new g({color:s}):r.material.color=s,o!=null&&"outline"in r&&((u=r.outline)==null?void 0:u.color)!=null&&(r.outline.color=h(r.outline.color,o))}})}function L(t,n,o){var l;(n=n??t.color)&&(t.color=h(n,o)),o!=null&&"outline"in t&&((l=t.outline)!=null&&l.color)&&(t.outline.color=h(t.outline.color,o))}function P(t,n,o){t&&(n||o!=null)&&(n&&(n=new a(n)),y(t)?v(t,n,o):m(t)&&L(t,n,o))}async function j(t,n){const o=t.symbolLayers;o&&await d(o,async l=>E(l,n))}async function E(t,n){switch(t.type){case"extrude":C(t,n);break;case"icon":case"line":case"text":$(t,n);break;case"path":O(t,n);break;case"object":await R(t,n)}}function $(t,n){const o=p(n);o!=null&&(t.size=o)}function p(t){for(const n of t)if(typeof n=="number")return n;return null}function C(t,n){t.size=typeof n[2]=="number"?n[2]:0}async function R(t,n){const{resourceSize:o,symbolSize:l}=await A(t),i=w(n,o,l);t.width=f(n[0],l[0],o[0],i),t.depth=f(n[1],l[1],o[1],i),t.height=f(n[2],l[2],o[2],i)}function O(t,n){const o=w(n,k,[t.width,void 0,t.height]);t.width=f(n[0],t.width,1,o),t.height=f(n[2],t.height,1,o)}function w(t,n,o){for(let l=0;l<3;l++){const i=t[l];switch(i){case"symbol-value":{const r=o[l];return r!=null?r/n[l]:1}case"proportional":break;default:if(i&&n[l])return i/n[l]}}return 1}async function A(t){const{computeObjectLayerResourceSize:n}=await z(()=>import("./symbolLayerUtils-CumMKJY0.js"),__vite__mapDeps([0,1,2]),import.meta.url),o=await n(t,10),{width:l,height:i,depth:r}=t,c=[l,r,i];let u=1;for(let e=0;e<3;e++){const s=c[e];if(s!=null){u=s/o[e];break}}for(let e=0;e<3;e++)c[e]==null&&(c[e]=o[e]*u);return{resourceSize:o,symbolSize:c}}function f(t,n,o,l){switch(t){case"proportional":return o*l;case"symbol-value":return n??o;default:return t}}function D(t,n){const o=p(n);if(o!=null)switch(t.type){case"simple-marker":t.size=o;break;case"picture-marker":{const l=t.width/t.height;l>1?(t.width=o,t.height=o*l):(t.width=o*l,t.height=o);break}case"simple-line":t.width=o;break;case"text":t.font.size=o}}async function B(t,n){if(t&&n)return y(t)?j(t,n):void(m(t)&&D(t,n))}function T(t,n,o){if(t&&n!=null)if(y(t)){const l=t.symbolLayers;l&&l.forEach(i=>{if(i.type==="object")switch(o){case"tilt":i.tilt=(i.tilt??0)+n;break;case"roll":i.roll=(i.roll??0)+n;break;default:i.heading=(i.heading??0)+n}i.type==="icon"&&(i.angle+=n)})}else m(t)&&(t.type!=="simple-marker"&&t.type!=="picture-marker"&&t.type!=="text"||(t.angle+=n))}async function U(t,n){return await t.fetchSymbol(n)||t.fetchCIMSymbol(n)}export{T as D,U as N,B as R,P as g,N as h};
